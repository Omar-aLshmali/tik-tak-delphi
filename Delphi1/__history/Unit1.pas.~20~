unit Unit1;

interface

uses
  Windows,
  Messages,
  SysUtils,
  Variants,
  Classes,
  Graphics,
  Controls,
  Forms,
  Dialogs,
  StdCtrls;

type
  TForm1 = class(TForm)
    btn1: TButton;
    btn2: TButton;
    btn3: TButton;
    btn4: TButton;
    btn5: TButton;
    btn6: TButton;
    btn7: TButton;
    btn8: TButton;
    btn9: TButton;
    play1: TLabel;
    play2: TLabel;
    draw_result: TLabel;
    New_play: TButton;
    New_begin: TButton;
    End_play: TButton;
    begin_play: TLabel;
    CheckBox1: TCheckBox;

    procedure End_playClick(Sender: TObject);
    procedure btnClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure New_playClick(Sender: TObject);
    procedure New_beginClick(Sender: TObject);
  private
    ButtonArray: array[1..9] of TButton;
    playerInput, player, player1, player2, draw: Integer;
    function IsWinn(): Boolean;
    procedure NewPlay();
    procedure IsDraw();
    procedure RandomBegin();
    procedure PcInputNomral();
    procedure PcInputHard();
    procedure PcInput(Sender: TObject);
    procedure PlayHelp(i: Integer);
    { Private-Deklarationen }
  public

    { Public-Deklarationen }
  end;

var

  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.New_playClick(Sender: TObject);
begin

  NewPlay();
end;

// Reset everything to zero and start a new game

procedure TForm1.New_beginClick(Sender: TObject);
var
  i: integer;
begin
  playerInput := 0;
  player1 := 0;
  player2 := 0;
  draw := 0;
  play1.Caption := 'Du : ' + inttostr(player1);
  play2.Caption := 'Gegner : ' + inttostr(player2);
  draw_result.Caption := 'Uneuntschieden : ' + inttostr(draw);

  for i := low(ButtonArray) to high(ButtonArray) do
    ButtonArray[i].Caption := '';

end;

// Play end

procedure TForm1.End_playClick(Sender: TObject);

begin
  Close();

end;

procedure TForm1.btnClick(Sender: TObject);
var
  button: TButton;

begin

  button := sender as TButton;

  if (player = 0) and (button.Caption = '') then
  begin
    button.Caption := 'X';
    player := 1;
    Inc(playerInput);
  end;

  if IsWinn() then

  begin
    if button.Caption = 'X' then
    begin
      Showmessage('Du hast gewonnen');

      Inc(player1);
      NewPlay();
    end

  end

 else  if (playerInput = 9) and (IsWinn() <> true) then
  begin
    inc(draw);
    IsDraw();

  end;

  PcInput(sender);
end;

// Check method for profit opportunities

function TForm1.IsWinn(): Boolean;
var
  m, n, i: Integer;
begin

  i := 1;

  //  Vertical profit opportunities
  while i < 9 do

  begin
    if (ButtonArray[i].Caption <> '') and (ButtonArray[i].Caption = ButtonArray[i + 1].Caption) and
      (ButtonArray[i].Caption = ButtonArray[i + 2].Caption) then
    begin
      result := true;
      exit
    end;

    i := i + 3;
  end;

  // Horizontal profit opportunities
  n := 1;
  while n < 4 do

  begin

    if (ButtonArray[n].Caption <> '') and (ButtonArray[n].Caption = ButtonArray[n + 3].Caption) and
      (ButtonArray[n].Caption = ButtonArray[n + 6].Caption) then

    begin
      result := true;
      exit
    end;
    n := n + 1;
  end;

  // Mid-profit opportunities
  m := 1;
  while m < 4 do
  begin

    if (ButtonArray[m].Caption <> '') and (ButtonArray[m].Caption = ButtonArray[m + 5 - m].Caption) and
      (ButtonArray[m].Caption = ButtonArray[10 - m].Caption) then
    begin
      result := true;
      exit
    end;

    m := m + 2;
  end;

  result := false;

end;

procedure TForm1.FormCreate(Sender: TObject);
var
  i: Integer;
begin
  RandomBegin();

  for i := low(ButtonArray) to high(ButtonArray) do
    ButtonArray[i] := FindComponent('btn' + inttoStr(i)) as TButton

end;

// got the result and repeat the round
procedure TForm1.NewPlay();
var
  i: Integer;

begin

  playerInput := 0;

  draw_result.Caption := 'Unentschieden : ' + inttostr(draw);
  play1.Caption := 'Du : ' + inttostr(player1);
  play2.Caption := 'Gegner : ' + inttostr(player2);

  for i := low(ButtonArray) to high(ButtonArray) do
    ButtonArray[i].Caption := '';

  RandomBegin();
end;

// when nobody wins
procedure TForm1.IsDraw();

begin

  Showmessage('Unentschieden');
   NewPlay();
end;

// Random Function ,who starts
procedure TForm1.RandomBegin();
var
  randomPlayer: Integer;
begin
  randomPlayer := Random(2);
  if RandomPlayer = 0 then
  begin
    begin_play.Caption := 'Du fängst an';
    player := 0;
  end
  else
  begin
    begin_play.Caption := ' PC fängt an';
    player := 1;
  end;

  if CheckBox1.checked then
  begin
   PcInputHard();
  end
  else
  begin
   PcInputNomral();
  end;

end;

//  Pc input difficult option
procedure TForm1.PcInputHard();

begin
 if (player=1) and (ButtonArray[7].Caption='') then
 begin
  PlayHelp(7);
 end
     else if (ButtonArray[1].Caption='') and (ButtonArray[2].Caption='O')and(ButtonArray[3].Caption='O') or(ButtonArray[1].Caption='')and(ButtonArray[5].Caption='O')and(ButtonArray[9].Caption='O') or(ButtonArray[1].Caption='')and(ButtonArray[7].Caption='O')and(ButtonArray[4].Caption='O') then
   begin
       PlayHelp(1);
   end
 else if (ButtonArray[2].Caption='') and (ButtonArray[8].Caption='O')and(ButtonArray[5].Caption='O') or(ButtonArray[2].Caption='')and(ButtonArray[1].Caption='O')and(ButtonArray[3].Caption='O') then
   begin
       PlayHelp(2);
   end
     else if (ButtonArray[3].Caption='') and (ButtonArray[7].Caption='O')and(ButtonArray[5].Caption='O') or(ButtonArray[3].Caption='')and(ButtonArray[2].Caption='O')and(ButtonArray[1].Caption='O') or(ButtonArray[3].Caption='')and(ButtonArray[9].Caption='O')and(ButtonArray[6].Caption='O') then
   begin
       PlayHelp(3);
   end
   else if (ButtonArray[8].Caption='') and (ButtonArray[5].Caption='O')and(ButtonArray[2].Caption='O') or(ButtonArray[8].Caption='')and(ButtonArray[7].Caption='O')and(ButtonArray[9].Caption='O') then
   begin
       PlayHelp(8);
   end
   else if (ButtonArray[9].Caption='') and (ButtonArray[8].Caption='O')and(ButtonArray[7].Caption='O') or(ButtonArray[9].Caption='')and(ButtonArray[3].Caption='O')and(ButtonArray[6].Caption='O') or(ButtonArray[9].Caption='')and(ButtonArray[1].Caption='O')and(ButtonArray[5].Caption='O') then
   begin
       PlayHelp(9);
   end
    else if (ButtonArray[5].Caption='') and (ButtonArray[2].Caption='O')and(ButtonArray[8].Caption='O') or(ButtonArray[5].Caption='')and(ButtonArray[1].Caption='O')and(ButtonArray[9].Caption='O')  then
   begin
       PlayHelp(5);
   end
     else if (ButtonArray[4].Caption='') and (ButtonArray[1].Caption='O')and(ButtonArray[7].Caption='O') or(ButtonArray[4].Caption='')and(ButtonArray[5].Caption='O')and(ButtonArray[6].Caption='O')  then
   begin
       PlayHelp(4);
   end
   //
    else if (ButtonArray[2].Caption='') and (ButtonArray[8].Caption='X')and(ButtonArray[5].Caption='X') or(ButtonArray[2].Caption='')and(ButtonArray[1].Caption='X')and(ButtonArray[3].Caption='X') then
   begin
       PlayHelp(2);
   end
   else if (ButtonArray[8].Caption='') and (ButtonArray[5].Caption='X')and(ButtonArray[2].Caption='X') or(ButtonArray[8].Caption='')and(ButtonArray[7].Caption='X')and(ButtonArray[9].Caption='X') then
   begin
       PlayHelp(8);
   end
   else if (ButtonArray[9].Caption='') and (ButtonArray[8].Caption='X')and(ButtonArray[7].Caption='X') or(ButtonArray[9].Caption='')and(ButtonArray[3].Caption='X')and(ButtonArray[6].Caption='X') or(ButtonArray[9].Caption='')and(ButtonArray[1].Caption='X')and(ButtonArray[5].Caption='X') then
   begin
       PlayHelp(9);
   end
    else if (ButtonArray[1].Caption='') and (ButtonArray[2].Caption='X')and(ButtonArray[3].Caption='X') or(ButtonArray[1].Caption='')and(ButtonArray[5].Caption='X')and(ButtonArray[9].Caption='X') or(ButtonArray[1].Caption='')and(ButtonArray[7].Caption='X')and(ButtonArray[4].Caption='X') then
   begin
       PlayHelp(1);
   end
    else if (ButtonArray[3].Caption='') and (ButtonArray[7].Caption='X')and(ButtonArray[5].Caption='X') or(ButtonArray[3].Caption='')and(ButtonArray[2].Caption='X')and(ButtonArray[1].Caption='X') or(ButtonArray[3].Caption='')and(ButtonArray[9].Caption='X')and(ButtonArray[6].Caption='X') then
   begin
       PlayHelp(3);
   end
    else if (ButtonArray[5].Caption='') and (ButtonArray[2].Caption='X')and(ButtonArray[8].Caption='X') or(ButtonArray[5].Caption='')and(ButtonArray[1].Caption='X')and(ButtonArray[9].Caption='X')  then
   begin
       PlayHelp(5);
   end
     else if (ButtonArray[4].Caption='') and (ButtonArray[5].Caption='X')and(ButtonArray[6].Caption='X') or(ButtonArray[4].Caption='')and(ButtonArray[1].Caption='X')and(ButtonArray[7].Caption='X')  then
   begin
       PlayHelp(4);
   end
   //
   else if (player=1) and (ButtonArray[5].Caption='') then

   begin
   PlayHelp(5);
   end
   else if (player=1) and (ButtonArray[6].Caption='') then

   begin
   PlayHelp(6);
   end
     else if (player=1) and (ButtonArray[2].Caption='') then

   begin
   PlayHelp(2);
   end
      else if (player=1) and (ButtonArray[1].Caption='') then

   begin
   PlayHelp(1);
   end
       else if (player=8) and (ButtonArray[1].Caption='') then

   begin
   PlayHelp(8);
   end;
end;

//  Pc input simple option
procedure TForm1.PcInputNomral();
var
  i, j, inputRandom: Integer;
begin
  for j := low(ButtonArray) to 100 do
  begin
    inputRandom := Random(10);
    for i := low(ButtonArray) to high(ButtonArray) do
    begin
      if (inputRandom = i) and (ButtonArray[i].Caption = '') and (player = 1) then
      begin
        buttonArray[i].Caption := 'O';
        inc(playerinput);
        player := player - 1;

      end;

    end;
    if (player = 0) then
    begin
      break;
    end;

  end;

end;

 // Pc input options difficult and simple
procedure TForm1.PcInput(Sender: TObject);
var
  button: TButton;
begin
  button := sender as TButton;
  if CheckBox1.checked then
   begin
     PcInputHard();
   end
   else
   begin
     PcInputNomral();
   end;


  if IsWinn() then

  begin

    Showmessage('Gegner hat gewonnen');
    Inc(player2);
    NewPlay();

  end

  else if (playerInput = 9) and (IsWinn() <> true) then
  begin
    inc(draw);
    IsDraw();
  end;
end;

procedure TForm1.PlayHelp(i: Integer);
begin
 ButtonArray[i].Caption:='O';
       player := player - 1;
       inc(playerinput);
end;
end.

